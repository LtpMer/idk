<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Animation</title>
    <!-- Load Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #0d1117; /* Dark background for better contrast */
            color: #ffffff;
            margin: 0;
            overflow: hidden;
        }
        canvas {
            background-color: transparent;
            display: block;
            border-radius: 1rem;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <h1 class="text-3xl font-bold mb-4">Forming "Hi" with Particles</h1>

    <div class="relative w-full h-full flex justify-center items-center">
        <canvas id="particleCanvas"></canvas>
    </div>

    <button id="restartButton" class="mt-8 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-full shadow-lg transition-transform transform hover:scale-105">
        Restart Animation
    </button>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('particleCanvas');
            const ctx = canvas.getContext('2d');
            const restartButton = document.getElementById('restartButton');

            let particles = [];
            const textToAnimate = "Hi";

            // Set canvas size to fill the viewport
            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }

            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();

            /**
             * The Particle class represents an individual particle in the animation.
             * It has properties for its current position, target position, and color.
             */
            class Particle {
                constructor(x, y) {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    // Initial velocity is set to a random position on the canvas edges
                    if (Math.random() > 0.5) {
                        this.x = Math.random() > 0.5 ? 0 : canvas.width;
                    } else {
                        this.y = Math.random() > 0.5 ? 0 : canvas.height;
                    }
                    this.targetX = x;
                    this.targetY = y;
                    this.color = `hsl(${Math.random() * 360}, 100%, 75%)`; // Random color
                    this.speed = 0.05 + Math.random() * 0.05; // Randomize speed for a dynamic effect
                }

                update() {
                    // Move the particle closer to its target position
                    this.x += (this.targetX - this.x) * this.speed;
                    this.y += (this.targetY - this.y) * this.speed;
                }

                draw() {
                    // Draw the particle as a small, glowing circle
                    ctx.fillStyle = this.color;
                    ctx.beginPath();
                    ctx.arc(this.x, this.y, 1.5, 0, Math.PI * 2);
                    ctx.fill();
                }
            }

            /**
             * Initializes the particles by drawing the text off-screen and
             * creating a particle for each pixel of the text.
             */
            function initParticles() {
                particles = [];
                // Create a temporary off-screen canvas to render the text
                const tempCanvas = document.createElement('canvas');
                const tempCtx = tempCanvas.getContext('2d');
                tempCanvas.width = canvas.width;
                tempCanvas.height = canvas.height;
                
                // Text properties
                tempCtx.font = "bold 200px Inter";
                tempCtx.textAlign = "center";
                tempCtx.textBaseline = "middle";
                tempCtx.fillStyle = "#ffffff";
                
                // Get the text dimensions to center it
                const textMetrics = tempCtx.measureText(textToAnimate);
                const textWidth = textMetrics.width;
                const textHeight = textMetrics.actualBoundingBoxAscent + textMetrics.actualBoundingBoxDescent;

                tempCtx.fillText(textToAnimate, canvas.width / 2, canvas.height / 2);

                // Get the image data from the temporary canvas
                const imageData = tempCtx.getImageData(0, 0, tempCanvas.width, tempCanvas.height);

                // Iterate through the pixels of the text to create particles
                for (let y = 0; y < imageData.height; y += 4) {
                    for (let x = 0; x < imageData.width; x += 4) {
                        const alpha = imageData.data[(y * imageData.width + x) * 4 + 3];
                        // If the pixel is not transparent, create a particle at that position
                        if (alpha > 128) {
                            particles.push(new Particle(x, y));
                        }
                    }
                }
            }

            /**
             * The main animation loop.
             * It clears the canvas, updates and draws each particle.
             */
            function animate() {
                // Clear the entire canvas with a semi-transparent black overlay
                // This creates a trail effect for the particles
                ctx.fillStyle = 'rgba(13, 17, 23, 0.1)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Update and draw each particle
                particles.forEach(particle => {
                    particle.update();
                    particle.draw();
                });

                requestAnimationFrame(animate);
            }

            // Function to restart the animation
            function restart() {
                initParticles();
                animate();
            }

            // Attach event listener to the restart button
            restartButton.addEventListener('click', restart);

            // Start the animation on window load.
            window.onload = function() {
                restart();
            };
        });
    </script>
</body>
</html>
